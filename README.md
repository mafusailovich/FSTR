# FSTR
FSTR REST API

Здравствуйте. 
Это RESTAPI на Django Rest Framework для вымышленного туристического приложения.

Когда турист поднимется на перевал, он сфотографирует его и внесёт нужную информацию с помощью мобильного приложения:

- координаты объекта и его высоту;
- название объекта;
- несколько фотографий;
- информацию о пользователе, который передал данные о перевале: имя пользователя (ФИО строкой), почта, телефон.

После этого турист нажмёт кнопку «Отправить» в мобильном приложении.

Для этого реализован метод, принимающий POST запрос по адресу http://адрес_сервера:8000/api/v1/submitData/
Пример запроса 
````
{
    "beautytitle": "пер.",
    "title": "Перевал 3",
    "other_titles": "другие title",
    "connect": "дополнительная информация", #может быть пустым
    "add_time": "2023-01-27T00:04:00Z",
    "users": {
        "email": "test1@yandex.ru",
        "name": "Иван",
        "fam": "Иванов",
        "otc": "Иванович",
        "phone": "+11111111"
    },
    "coords": {
        "latitude": 88.77,
        "longitude": 88.8,
        "height": 21
    },
    "level_winter": "А1", #поля level могут быть пустыми
    "level_spring": "Б2",
    "level_summer": "C3",
    "level_autumn": "M4",
    "images": [{"title": "Название","img": "<картинка в бинарном виде>"},{"title": "Название 1","img":"<картинка в бинарном виде>"}]
}
````
Организация базы данных. 
В базе данных четыре основные таблицы:
- Users (содержит сведения о пользователе, который добавляет информацияю, поле email уникально);
- PerevalAdded (информация о самих перевалах, название перевала (поле title) уникально, имеют связь с таблицей пользователей как foreignkey);
- Coords (координаты перевала, связаны с перевалом связью onetoone);
- Images (фотографии перевала)

Images и PerevalAdded связаны при помощи таблицы PerevalImage, в которой имются ForeignKeys на каждую из них. При добавлении нового перевала устанавливается
связь через эту таблицу.

Есть ещё таблица PerevalAreas, но по заданию не ясно как её использовать (в изначальной базе ФСТР она есть, но нигде не говорится о ней). 

Дополнительно реализованы методы: 
- обновление отдельной записи о перевале (метод PATCH)
http://адрес_сервера:8000/api/v1/submitData/<id записи в таблице перевалов>
Код запроса для обновления записи аналогичен приведенному выше. Система не обновляет данные о пользователе. 

- чтение информации о перевале (метод GET)
http://адрес_сервера:8000/api/v1/submitData/<id записи в таблице перевалов>
Код ответа аналогичен приведенному выше.

- чтение информации о перевалах, добавленных конкретным пользователейм (метод GET)
http://адрес_сервера:8000/api/v1/submitData/?user_email=<адрес электронной почты>
Код ответа:
````
{
    "email": "test1@yandex.ru",
    "name": "Иван",
    "fam": "Иванов ",
    "otc": "Иванович",
    "phone": "+111111111",
    "пер. Перевал 2": {
        "beautytitle": "пер.",
        "title": "Перевал 2",
        "other_titles": "доп",
        "connect": "доп",
        "add_time": "2023-01-27T00:04:00Z",
        "level_winter": "А1",
        "level_spring": "B2",
        "level_summer": "",
        "level_autumn": "",
        "status": "new",
        "coords": {
            "latitude": 88.78,
            "longitude": 88.8,
            "height": 21
        },
        "images": [
            {
                "title": "a;sldkjf",
                "img": "<memory at 0x000002666CC2DA80>"
            },
            {
                "title": "111",
                "img": "<memory at 0x000002666CC2FA00>"
            }
        ]
    }
}
````


